<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TRIVIER - 여행사를 위한 협업툴</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
</head>

<body>

  <div class="app-container">
    <nav class="sidebar">
      <div class="logo">
        <h2>TRIVIER</h2>
        <p>Collaborative Tool</p>
      </div>
      <ul class="menu">
        <li onclick="showSection('home')" class="active"><i class="fas fa-home"></i> 홈</li>
        <li onclick="showSection('regional')"><i class="fas fa-map-marked-alt"></i> 지역 상품 기획</li>
        <li onclick="showSection('comm')"><i class="fas fa-comments"></i> 주제소통</li>
        <li onclick="showSection('theme')"><i class="fas fa-lightbulb"></i> 테마 상품 기획</li>
        <li onclick="showSection('finalize')"><i class="fas fa-check-circle"></i> 투표 및 정보</li>
      </ul>
      <div class="footer-info">
        <p>5조 프로젝트</p>
      </div>
    </nav>

    <main class="content">

      <!-- Communication section: 주제소통 / 일상소통 -->
      <section id="comm" class="page">
        <div class="comm-header">
          <div class="comm-tabs">
            <button class="comm-tab-btn active" onclick="switchCommTab('topic')">주제소통</button>
            <button class="comm-tab-btn" onclick="switchCommTab('daily')">일상소통</button>
          </div>
        </div>

        <div class="comm-body">
          <div class="comm-top-row">
            <div class="comm-chips">
              <span class="chip">우산</span>
              <span class="chip">차수막</span>
              <span class="chip">스크린도어</span>
              <span class="chip">버스 알림 어플</span>
              <span class="chip">청소기</span>
            </div>
            <div class="comm-more">더보기</div>
          </div>

          <div class="comm-content">
            <div id="comm-topic" class="comm-panel active">
              <div class="comm-canvas">
                <!-- large empty canvas area -->
              </div>
            </div>
            <div id="comm-daily" class="comm-panel">
              <div class="comm-canvas">
                <!-- daily chat placeholder -->
              </div>
            </div>

            <!-- Typing area: replace decorative keyboard with an input for user messages -->
            <div class="comm-typing">
              <input id="comm-input" type="text" placeholder="메시지를 입력하세요...">
              <button onclick="sendCommMessage()">전송</button>
            </div>
          </div>
        </div>
      </section>

      <section id="home" class="page active">
        <div class="hero">
          <h1>여행사를 위한 협업툴, TRIVIER</h1>
          <p class="subtitle">창의적 기획과 문제 해결을 위한 최적의 솔루션</p>
          <div class="stamp-box">
            <div class="stamp">SYDNEY</div>
            <div class="stamp">ROME</div>
            <div class="stamp">PARIS</div>
          </div>
        </div>
        <div class="intro-box">
          <h3>프로젝트 개요</h3>
          <ul>
            <li><strong>제안 대상:</strong> 여행사 여행 상품 기획팀</li>
            <li><strong>목적:</strong> 효율적인 협업 시스템 구축 및 창의적 아이디어 생성</li>
            <li><strong>기대 효과:</strong> 협업 과정의 번거로움 감소 및 이익 추구</li>
          </ul>
        </div>
      </section>

      <section id="regional" class="page">
        <div class="tab-header">
          <button onclick="switchSubTab('cal-tab')" class="sub-tab-btn active">출장 캘린더</button>
          <button onclick="switchSubTab('route-tab')" class="sub-tab-btn">투어 일정</button>
        </div>

        <!-- Merge calendar + travel-record into a single tab (출장 캘린더) -->
        <div id="cal-tab" class="sub-content active">
          <h3><i class="far fa-calendar-alt"></i> 2026년 1월 출장 일정</h3>
          <div class="cal-and-feed">
            <div class="cal-side">
              <div class="calendar-grid" id="calendar">
              </div>
            </div>

            <!-- feed removed from calendar side; use modal popup on date click -->
          </div>
        </div>

        <div id="route-tab" class="sub-content">
          <h3><i class="fas fa-route"></i> 투어 일정 회의</h3>

          <div class="trip-length-control">
            <label>여행 기간 (일):</label>
            <input type="number" id="route-trip-days" min="1" max="14" value="4">
            <button id="route-trip-next">다음</button>
            <button id="route-trip-reset" style="display:none;">초기화</button>
          </div>

          <div id="route-day-planner" class="day-planner" style="display:none;">
            <div id="route-day-columns" class="day-columns"></div>
          </div>

          <div id="route-placeholder" class="route-placeholder">
            <p>여행 기간을 선택하고 '다음'을 눌러 일차별 일정을 생성하세요.</p>
          </div>
          <!-- Map for route/tour planning -->
          <div id="route-map" class="route-map" aria-label="투어 지도" style="height:320px; display:none; margin-top:12px;"></div>
        </div>
      </section>

      <section id="theme" class="page">
        <div class="layout-grid-theme">
          <div class="theme-card">
            <h3>일상 공유 & 브레인스토밍</h3>
            <div class="chat-keywords" id="keyword-container">
              <span class="keyword">우산</span>
              <span class="keyword">차수막</span>
              <span class="keyword">스크린도어</span>
              <span class="keyword">버스 알림 어플</span>
            </div>
            <div class="chat-input-box">
              <input type="text" id="brainstorm-input" placeholder="키워드 입력...">
              <button onclick="addKeyword()">추가</button>
            </div>
          </div>

          <div class="theme-card">
            <h3>오늘의 랜덤 질문</h3>
            <div class="chat-box">
              <div id="random-chat" class="chat-list">
                <!-- chat messages will be appended here -->
              </div>

              <div class="chat-controls">
                <button onclick="generateQuestion()" class="refresh-btn"><i class="fas fa-sync-alt"></i> 새 질문</button>

                <div class="chat-input">
                  <input type="text" id="random-input" placeholder="답변을 입력하여 영감 얻기...">
                  <button onclick="sendRandomReply()">전송</button>
                </div>
              </div>
            </div>
          </div>

          <div class="theme-card full-width">
            <h3>AI 액티비티/장소 추천</h3>
            <div class="ai-box">
              <div class="ai-input">
                <input type="text" id="ai-keyword" placeholder="테마 키워드 입력 (예: 등산, 물, 힐링)">
                <button onclick="getAIRecommendation()">AI 검색</button>
              </div>
              <div id="ai-result" class="ai-result">
              </div>
            </div>
          </div>
        </div>
      </section>

      <section id="finalize" class="page">
        <h2>최종 기획안 검토</h2>

        <div class="info-dashboard">
          <div class="info-card">
            <h3><i class="fas fa-coins"></i> 환율 정보 (HKD/KRW)</h3>
            <div class="rate-display">
              <div class="flag">🇭🇰 1 HKD</div>
              <div class="eq">=</div>
              <div class="val">🇰🇷 189.09 KRW</div>
            </div>
          </div>
          <div class="info-card">
            <h3><i class="fas fa-cloud-sun"></i> 홍콩 주간 예보</h3>
            <div class="weather-row">
              <span>오늘</span> <i class="fas fa-sun" style="color:orange"></i> 17°/25°
            </div>
            <div class="weather-row">
              <span>내일</span> <i class="fas fa-cloud-sun" style="color:gray"></i> 18°/28°
            </div>
            <div class="weather-row">
              <span>모레</span> <i class="fas fa-cloud" style="color:skyblue"></i> 15°/26°
            </div>
          </div>
          <div class="info-card">
            <h3><i class="fas fa-passport"></i> 비자 정보</h3>
            <ul>
              <li>대한민국 여권 소지자 90일 무비자</li>
              <li>여권 유효기간 6개월 이상 필수</li>
              <li>별도 도착 비자 불필요</li>
            </ul>
          </div>
        </div>

        <div class="vote-section">
          <h3>상품 기획안 투표</h3>
          <p>이번 [홍콩 3박 4일 - 지역/테마 융합 상품] 기획안을 승인하시겠습니까?</p>
          <div class="vote-buttons">
            <button onclick="vote('yes')" class="vote-btn yes">YES (승인)</button>
            <button onclick="vote('no')" class="vote-btn no">NO (보류)</button>
          </div>
          <div id="vote-result" class="vote-result"></div>
        </div>
      </section>

    </main>
  </div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="script.js"></script>
  <!-- Feed modal (opens when a calendar date is clicked) -->
  <div id="feed-modal" class="modal-overlay" style="display:none;">
    <div class="modal-content">
      <button id="feed-modal-close" class="modal-close">✕</button>
      <h3 id="feed-modal-title">현장 답사 기록</h3>
      <div id="feed-modal-body" class="feed-modal-body">
        <!-- feed cards will be injected here -->
      </div>
    </div>
  </div>

  <!-- Add Post modal (opens when clicking '게시물 추가' in day panel) -->
  <div id="add-post-modal" class="modal-overlay add-modal" style="display:none;">
    <div class="add-post-content">
      <button class="modal-close" onclick="closeAddPostModal()">✕</button>
      <h3 class="add-post-title">기본 일정 및 동선 입력</h3>
      <div class="add-post-body">
        <div class="form-row"><span class="label oval">일차</span><span id="addpost-day" class="value">-</span></div>
        <div class="form-row"><span class="label oval">시각</span><input id="addpost-time" class="value" type="time"></div>
        <div class="form-row"><span class="label oval">예상 소요시간</span><input id="addpost-duration" class="value" type="text" placeholder="분 단위 입력 (예: 100)"></div>
        <div class="form-row full"><span class="label oval">다음 장소와의 거리 및 이동 시간</span>
          <textarea id="addpost-distance" class="value multi" rows="2" placeholder="예: 1.4km / 차량-6분, 대중교통-17분"></textarea>
        </div>
        <div class="form-row"><span class="label oval">1인 예상 경비</span><input id="addpost-cost" class="value" type="text" placeholder="예: 무료"></div>
        <div class="form-row"><span class="label oval">팀원 평점</span><input id="addpost-rating" class="value" type="text" placeholder="예: 4.5/5"></div>
        <div style="display:flex; gap:10px; justify-content:flex-end; margin-top:8px;">
          <button onclick="closeAddPostModal()" style="background:#fff; border:1px solid rgba(0,0,0,0.08); padding:8px 12px; border-radius:8px;">취소</button>
          <button onclick="saveAddPost()" style="background:var(--primary-brown); color:#fff; border:none; padding:8px 12px; border-radius:8px;">저장</button>
        </div>
      </div>
    </div>
  </div>
</body>

</html>